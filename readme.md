# ToNRoundCounter

ToNRoundCounter は ToN プレイ時にラウンド数やテラー情報を表示するための Windows 向けツールです。
WebSocket や OSC による連携、オート自殺設定、クラウド同期などゲームの進行を支援する多くの機能を備えています。

## 機能一覧
・接続ステータスバー  
WebSocket/OSC の接続状態をヘッダーに常時表示し、最前面固定と設定画面呼び出しをワンクリックで切り替えてプレイ状況を素早く確認できます。  
・ラウンド情報パネル  
ラウンド種別やマップ、テラー、アイテム、被ダメージを一画面に集約し、次ラウンド予測と無操作時間の色分け警告で進行管理を支援します。  
・テラー情報カード  
テラー名ごとの詳細データをカード表示し、対応するラウンドでは出現までのカウントダウンを自動更新して注意すべきタイミングを示します。  
・ラウンド統計ビュー  
ラウンド種別ごとの出現数・生存率とテラー別内訳を自動集計し、フィルター設定に従った読みやすいリッチテキストとして一覧化します。  
・ラウンドログビュー  
進行中に蓄積したラウンドログを最新順に表示し、履歴を即時コピーできる形式で共有や振り返りを簡単に行えます。  
・ラウンドログ自動保存  
アプリ終了時にラウンド履歴をタイムスタンプ付きファイルへ書き出し、記録がない場合はメッセージを残してログ管理を自動化します。  
・クラウドラウンド同期  
ToNRoundCounter-Cloud API へラウンド結果を自動送信し、テラーやマップ、アイテム情報を含む記録をサーバー側に保存して共有できます。  
・Discord通知  
ラウンド結果を整形した埋め込みメッセージとして Discord Webhook に送信し、死亡・生存や取得アイテムを即時に共有できます。  
・自動自殺スケジューラ  
ラウンド開始やテラー確定時に条件マッチングで即時/遅延の自動自殺を実行し、チェックリストやプリセット・曖昧一致設定で柔軟に制御できます。  
・OSCアバター連携  
OSC メッセージで自動自殺の開始・遅延・中止や警告アラート送信を外部アバターから操作でき、設定状態をリアルタイムに反映します。  
・インスタンス共有アラート  
専用 WebSocket へ接続して他プレイヤーのアラートや自動自殺トリガーを受信・送信し、パーティ内で通知と行動を同期できます。  
・セーブコード取得  
OSC からの要求でクラウド API から最新セーブコードを取得し、例外時はキャッシュをクリップボードへ複製して素早く再利用できます。  
・AFK監視アラート  
無操作時間と移動速度を監視して段階的な色分け警告や警告音、OSC アラートを発し、必要に応じて離席中のリスクを抑制します。  
・アイテム音楽ギミック  
所持アイテム名と移動速度に合わせて登録したサウンドを 0.5 秒後からループ再生し、対象リストや速度範囲を GUI で一括管理できます。  
・パニッシュ検出アラート  
アイテム保持状況と横移動速度からパニッシュ/8ページの兆候を検知し、赤字表示と専用サウンドで危険を即時に知らせます。  
・OSCRepeater自動設定  
同梱の OscRepeater.exe を自動起動し、空きポート探索と既存プロセスの整理を行って複数 OSC アプリ併用時の競合を防ぎます。  
・外部アプリ自動起動  
設定やコマンドラインで登録したプログラムを起動時に連続実行し、存在確認や引数指定を行って配信・補助ツールを同時に立ち上げられます。  
・UIカスタマイズ  
ダークテーマや背景色、統計表示項目、テラー名の色固定、統計フィルターなどを細かく設定し、好みや視認性に合わせて UI を最適化できます。  
・モジュール拡張  
Modules フォルダーの DLL を自動読み込みして IModule 実装を DI に登録し、外部モジュールで機能を追加できます。  

## 必要環境
- .NET Framework 4.8
- Windows 10 以降

## ビルド
リポジトリをクローン後、Visual Studio などの .NET 4.8 対応 IDE で `ToNRoundCounter.sln` を開いてビルドします。

## テスト
`dotnet test` で単体テストを実行できます。
※ .NET Framework 4.8 の参照アセンブリが必要です。

## コマンドラインオプション
- `--launch <path>`: ToNRoundCounter 起動時に指定した実行ファイルを自動的に起動します。
- `--launch-args <arguments>`: `--launch` で起動する実行ファイルに渡すコマンドライン引数を指定します。

同じ内容はアプリ内の設定画面「自動起動設定」からも指定でき、次回以降の起動時に保存された実行ファイルと引数を利用して自動起動できます。

## アイテム音楽ギミック
- 設定画面の「アイテム音楽ギミック」から、対象となるアイテム名、再生したい音声ファイル、速度の下限・上限を指定できます。
- 指定したアイテムを保持した状態で設定した速度範囲を 0.5 秒間維持すると、音声がアイテム所持中にループ再生されます。

## ライセンス
本プロジェクトは [license.md](license.md) の条件の下で提供されます。


[![DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/lovetwice1012/ToNRoundCounter)
